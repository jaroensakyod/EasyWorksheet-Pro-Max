# science_generator.py - Science worksheet generation (Physics, Chemistry, Biology)
import random

class ScienceGenerator:
    """Generator for science worksheets based on IPST curriculum"""
    
    def __init__(self):
        self.topics = self._load_topics()
    
    def _load_topics(self):
        return {
            # ===== ระดับประถมศึกษา =====
            "ป.1": [
                ("1", "สิ่งต่างรอบตัวเรา (สิ่งมีชีวิต, สิ่งไม่มีชีวิต, สมบัติของวัสดุ)"),
                ("2", "พืชรอบตัวเรา (ส่วนประกอบของพืช, การเจริญเติบโต)"),
                ("3", "สัตว์รอบตัวเรา (สัตว์หลากหลายชนิด, การดูแลสัตว์)"),
                ("4", "ดวงดาวและท้องฟ้า (ดวงอาทิตย์, ดวงจันทร์, ดวงดาว)"),
                ("5", "สภาพอากาศ (หนาว, ร้อน, ฝน, ลม)"),
            ],
            "ป.2": [
                ("1", "สิ่งมีชีวิตกับการดำรงชีวิต (อาหาร, ที่อยู่อาศัย, การสืบพันธุ์)"),
                ("2", "สิ่งแวดล้อม (แสง, เสียง, ความร้อน)"),
                ("3", "น้ำและอากาศ (สถานะของน้ำ, การเกิดฝน)"),
                ("4", "ดิน (องค์ประกอบของดิน, ชนิดของดิน)"),
                ("5", "ท้องฟ้าและการพยากรณ์อากาศ"),
            ],
            "ป.3": [
                ("1", "ร่างกายของเรา (ระบบย่อยอาหาร, ระบบหายใจ)"),
                ("2", "พืชกับการดำรงชีวิต (การสังเคราะห์ด้วยแสง)"),
                ("3", "สิ่งมีชีวิตกับสิ่งแวดล้อม (ห่วงโซ่อาหาร)"),
                ("4", "วัสดุรอบตัว (โลหะ, ไม้, พลาสติก)"),
                ("5", "แรงและการเคลื่อนที่ (แรงผลัก, แรงดึง)"),
                ("6", "พลังงาน (ความร้อน, แสง, เสียง)"),
            ],
            "ป.4": [
                ("1", "ระบบร่างกาย (ระบบหมุนเวียนเลือด, ระบบขับถ่าย)"),
                ("2", "พืชที่หลากหลาย (การจำแนกพืช)"),
                ("3", "สิ่งมีชีวิตกับสิ่งแวดล้อม"),
                ("4", "สสาร (สถานะ, การเปลี่ยนแปลง)"),
                ("5", "แรงและความดัน"),
                ("6", "พลังงานไฟฟ้า (วงจรไฟฟ้า)"),
            ],
            "ป.5": [
                ("1", "ระบบสุขภาพ (ฮอร์โมน, การเจริญเติบโต)"),
                ("2", "การสืบพันธุ์ (สัตว์, พืช)"),
                ("3", "สิ่งแวดล้อม (การถ่ายทอดพลังงาน)"),
                ("4", "สสาร (อะตอม, ธาตุ, สารประกอบ)"),
                ("5", "แรงและการเคลื่อนที่ (แรงโน้มถ่วง)"),
                ("6", "คลื่น (เสียง, แสง)"),
            ],
            "ป.6": [
                ("1", "ระบบต่อมไร้ท่อ (ฮอร์โมน)"),
                ("2", "พันธุศาสตร์เบื้องต้น (ลักษณะทางพันธุกรรม)"),
                ("3", "วิวัฒนาการ (การเปลี่ยนแปลงของสิ่งมีชีวิต)"),
                ("4", "สสารและพลังงาน (กฎทรงพลังงาน)"),
                ("5", "ระบบสุริยะ (ดาวเคราะห์)"),
                ("6", "สิ่งแวดล้อม (การอนุรักษ์)"),
            ],
            # ===== มัธยมต้น =====
            "ม.1": {
                "เทอม 1": [
                    ("1", "สารบริสุทธิ์ (ธาตุ, สารประกอบ, สารผสม)"),
                    ("2", "หน่วยพื้นฐานของสิ่งมีชีวิต (เซลล์)"),
                    ("3", "หน่วยพื้นฐานของการดำรงชีวิตของพืช"),
                ],
                "เทอม 2": [
                    ("1", "พลังงานความร้อน"),
                    ("2", "กระบวนการเปลี่ยนแปลงลมฟ้าอากาศ"),
                ],
            },
            "ม.2": {
                "เทอม 1": [
                    ("1", "สารละลาย (ความเข้มข้น, pH)"),
                    ("2", "ร่างกายมนุษย์ (ระบบย่อยอาหาร, ระบบหายใจ)"),
                    ("3", "การเคลื่อนที่และแรง"),
                ],
                "เทอม 2": [
                    ("1", "งานและพลังงาน"),
                    ("2", "การแยกสาร (ตกตะกอน, กลั่น, สกัด)"),
                    ("3", "โลกและการเปลี่ยนแปลง"),
                ],
            },
            "ม.3": {
                "เทอม 1": [
                    ("1", "พันธุศาสตร์ (การถ่ายทอดลักษณะ)"),
                    ("2", "คลื่นและแสง"),
                    ("3", "ระบบสุริยะของเรา"),
                ],
                "เทอม 2": [
                    ("1", "ปฏิกิริยาเคมีและวัสดุในชีวิตประจำวัน"),
                    ("2", "ไฟฟ้า (ไฟฟ้ากระแส, แม่เหล็กไฟฟ้า)"),
                    ("3", "ระบบนิเวศและความหลากหลายทางชีวภาพ"),
                ],
            },
            # ===== มัธยมปลาย =====
            "ม.4": {
                "เคมี": [
                    ("1", "อะตอมและสมบัติของธาตุ"),
                    ("2", "พันธะเคมี (ไอออนิก, โควาเลนต์)"),
                    ("3", "ปริมาณสัมพันธ์ในปฏิกิริยาเคมี"),
                ],
                "ฟิสิกส์": [
                    ("1", "การเคลื่อนที่แนวตรง"),
                    ("2", "แรงและกฎการเคลื่อนที่ของนิวตัน"),
                    ("3", "งานและพลังงาน"),
                    ("4", "โมเมนตัมและการชน"),
                ],
                "ชีวะ": [
                    ("1", "ระบบย่อยอาหาร"),
                    ("2", "ระบบหายใจ"),
                    ("3", "ระบบหมุนเวียนเลือด"),
                ],
            },
            "ม.5": {
                "เคมี": [
                    ("1", "สมบัติของก๊าซและสมการเคมี"),
                    ("2", "อัตราการเกิดปฏิกิริยาเคมี"),
                    ("3", "สมดุลเคมี"),
                    ("4", "กรด-เบส"),
                ],
                "ฟิสิกส์": [
                    ("1", "การเคลื่อนที่ในระบบต่างๆ"),
                    ("2", "คลื่น (เสียง, แสง)"),
                    ("3", "ไฟฟ้ากระแสสลับ"),
                ],
                "ชีวะ": [
                    ("1", "ระบบต่อมไร้ท่อ"),
                    ("2", "ระบบสืบพันธุ์"),
                    ("3", "พันธุศาสตร์และการถ่ายทอดลักษณะ"),
                ],
            },
            "ม.6": {
                "เคมี": [
                    ("1", "ไฟฟ้าเคมี"),
                    ("2", "ธาตุอินทรีย์และสารชีวโมเลกุล"),
                    ("3", "เคมีอินทรีย์เบื้องต้น"),
                ],
                "ฟิสิกส์": [
                    ("1", "ไฟฟ้าสถิตและไฟฟ้ากระแส"),
                    ("2", "แม่เหล็กไฟฟ้า"),
                    ("3", "ฟิสิกส์อะตอมและนิวเคลียร์"),
                ],
                "ชีวะ": [
                    ("1", "เทคโนโลยีชีวภาพ"),
                    ("2", "วิวัฒนาการและนิเวศวิทยา"),
                    ("3", "สิ่งแวดล้อมและการอนุรักษ์"),
                ],
            },
        }
    
    def get_topics(self, grade, subject=None, term=None):
        """Get topics based on grade, optional subject and term"""
        if grade in ["ป.1", "ป.2", "ป.3", "ป.4", "ป.5", "ป.6"]:
            return self.topics.get(grade, [])
        
        if grade in ["ม.1", "ม.2", "ม.3"]:
            grade_data = self.topics.get(grade, {})
            if term:
                return grade_data.get(term, [])
            return grade_data
        
        if grade in ["ม.4", "ม.5", "ม.6"]:
            grade_data = self.topics.get(grade, {})
            if subject:
                return grade_data.get(subject, [])
            return grade_data
        
        return []

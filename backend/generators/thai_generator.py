# thai_generator.py - Thai language worksheet generation
import random

class ThaiGenerator:
    """Generator for Thai language worksheets"""
    
    def __init__(self):
        self.topics = self._load_topics()
    
    def _load_topics(self):
        return {
            # ===== ประถมศึกษา =====
            "ป.1": [
                ("1", "ตัวอักษรไทย (พยัญชนะไทย 44 ตัว, สระ 32 รูป)"),
                ("2", "สระในภาษาไทย (สระเดี่ยว, สระประสม)"),
                ("3", "การอ่านออกเสียง (อ่านคาบวรรณยุกต์)"),
                ("4", "คำศัพท์พื้นฐาน (คำสิ่งของ, คำสัตว์, คำครอบครัว)"),
                ("5", "ประโยคและเรื่องสั้น (ประโยคสั้น, นิทานสั้น)"),
            ],
            "ป.2": [
                ("1", "คำและความหมาย (คำซ้ำ, คำตรงข้าม, คำพ้อง)"),
                ("2", "หน่วยคำสรรพนาม (สรรพนาม, คำสรรพนามสรรพบุรณ)"),
                ("3", "การเขียน (เขียนตามคำบอก, เขียนประโยค)"),
                ("4", "นิทานพื้นบ้าน (นิทานชาดก, นิทานพื้นบ้านไทย)"),
                ("5", "การอ่านจับใจความ"),
            ],
            "ป.3": [
                ("1", "ชนิดของคำ (คำนาม, คำกริยา, คำคุณศัพท์)"),
                ("2", "กลอนแปด (โครงสร้างกลอนแปด)"),
                ("3", "การเขียนเรียงความสั้น"),
                ("4", "คำราชาศัพท์เบื้องต้น"),
                ("5", "วรรณคดีไทย (ขุนช้างขุนแผน, สุภาษิตไทย)"),
            ],
            "ป.4": [
                ("1", "หน่วยคำและความหมาย (คำภาษาต่างประเทศ, คำยืม)"),
                ("2", "ชนิดของคำ (คำสรรพนาม, คำสันธาน, คำบุพบท)"),
                ("3", "การอ่านตีความ (อ่านบทความ, อ่านข่าว)"),
                ("4", "การเขียนจดหมาย (จดหมายขอบคุณ, จดหมายเชิญ)"),
                ("5", "กลอนสุภาพ"),
            ],
            "ป.5": [
                ("1", "ประโยคและองค์ประกอบ (องค์ประกอบประโยค)"),
                ("2", "วลีและอนุประโยค (วลีนาม, วลีกริยา)"),
                ("3", "การเขียนรายงาน"),
                ("4", "วรรณคดีสุนทรียภาพ"),
                ("5", "ภาษาถิ่น (ภาษาอีสาน, ภาษาเหนือ, ภาษาใต้)"),
            ],
            "ป.6": [
                ("1", "หลักการใช้คำ (คำราชาศัพท์, คำสุภาพ)"),
                ("2", "การเขียนเชิงสร้างสรรค์"),
                ("3", "การอ่านวิเคราะห์"),
                ("4", "วรรณคดีวรรณกรรม"),
                ("5", "การนำเสนอ"),
            ],
            # ===== มัธยมต้น =====
            "ม.1": {
                "เทอม 1": [
                    ("1", "หน่วยคำสรรพนาม"),
                    ("2", "การเปลี่ยนรูปคำ"),
                    ("3", "วลีและอนุประโยค"),
                    ("4", "วรรณคดี (ร้อยกรองไทย, กาพย์ยานเอก)"),
                    ("5", "การอ่าน-เขียน"),
                ],
                "เทอม 2": [
                    ("1", "ประโยคและความหมาย"),
                    ("2", "การแต่งกลอน"),
                    ("3", "วรรณคดีอีสาน"),
                    ("4", "การเขียนเชิงสร้างสรรค์"),
                    ("5", "ภาษาถิ่นและภาษากลาง"),
                ],
            },
            "ม.2": {
                "เทอม 1": [
                    ("1", "คำและประโยคซ้อน"),
                    ("2", "กลอนแปด-กลอนสุภาพ"),
                    ("3", "วรรณคดีอีสาน"),
                    ("4", "การเขียนเชิงสร้างสรรค์"),
                    ("5", "ภาษาถิ่นและภาษากลาง"),
                ],
                "เทอม 2": [
                    ("1", "ภาษากับสังคม"),
                    ("2", "วรรณคดีไทย"),
                    ("3", "การอ่านวิพากษ์"),
                    ("4", "การเขียนวิชาการ"),
                    ("5", "วาทีวิทยา"),
                ],
            },
            "ม.3": {
                "เทอม 1": [
                    ("1", "ภาษากับสังคม"),
                    ("2", "วรรณคดีไทย"),
                    ("3", "การอ่านวิพากษ์"),
                    ("4", "การเขียนวิชาการ"),
                    ("5", "วาทีวิทยา"),
                ],
                "เทอม 2": [
                    ("1", "ภาษากับเทคโนโลยี"),
                    ("2", "ภาษาและอาชีพ"),
                    ("3", "วรรณคดีและภาพยนตร์"),
                    ("4", "การเขียนเพื่อสื่อสาร"),
                    ("5", "การประเมินผลงานภาษา"),
                ],
            },
            # ===== มัธยมปลาย =====
            "ม.4": {
                "เทอม 1": [
                    ("1", "ภาษากับการสื่อสาร"),
                    ("2", "หลักภาษาไทย"),
                    ("3", "วรรณคดีร่วมสมัย"),
                    ("4", "การเขียนเชิงวิชาการ"),
                    ("5", "สื่อและภาษา"),
                ],
                "เทอม 2": [
                    ("1", "ภาษาและวัฒนธรรม"),
                    ("2", "การนำเสนอ"),
                    ("3", "การเขียนสร้างสรรค์"),
                    ("4", "วาทีวิทยา"),
                    ("5", "วรรณคดีไทยและอาเซียน"),
                ],
            },
            "ม.5": {
                "เทอม 1": [
                    ("1", "ภาษาและวัฒนธรรม"),
                    ("2", "การนำเสนอ"),
                    ("3", "การเขียนสร้างสรรค์"),
                    ("4", "วาทีวิทยา"),
                    ("5", "วรรณคดีไทยและอาเซียน"),
                ],
                "เทอม 2": [
                    ("1", "ภาษากับเทคโนโลยี"),
                    ("2", "ภาษาและอาชีพ"),
                    ("3", "วรรณคดีและภาพยนตร์"),
                    ("4", "การเขียนเพื่อสื่อสาร"),
                    ("5", "การประเมินผลงานภาษา"),
                ],
            },
            "ม.6": {
                "เทอม 1": [
                    ("1", "ภาษากับเทคโนโลยี"),
                    ("2", "ภาษาและอาชีพ"),
                    ("3", "วรรณคดีและภาพยนตร์"),
                    ("4", "การเขียนเพื่อสื่อสาร"),
                    ("5", "การประเมินผลงานภาษา"),
                ],
                "เทอม 2": [
                    ("1", "การเตรียมความพร้อมสู่อาชีพ"),
                    ("2", "การสอบเข้ามหาวิทยาลัย"),
                    ("3", "การเป็นพลเมืองที่ดี"),
                    ("4", "การเรียนรู้ตลอดชีวิต"),
                    ("5", "สรุปความรู้ภาษาไทย"),
                ],
            },
        }
    
    def get_topics(self, grade, term=None):
        """Get topics based on grade and optional term"""
        if grade in ["ป.1", "ป.2", "ป.3", "ป.4", "ป.5", "ป.6"]:
            return self.topics.get(grade, [])
        
        if grade in ["ม.1", "ม.2", "ม.3", "ม.4", "ม.5", "ม.6"]:
            grade_data = self.topics.get(grade, {})
            if term:
                return grade_data.get(term, [])
            return grade_data
        
        return []
